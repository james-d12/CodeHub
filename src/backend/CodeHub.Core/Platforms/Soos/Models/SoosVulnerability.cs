using System.Text.Json.Serialization;

namespace CodeHub.Core.Platforms.Soos.Models;

[JsonSerializable(typeof(SoosVulnerability))]
public sealed record SoosVulnerability
{
    [JsonPropertyName("id")]
    public required string Id { get; init; }

    [JsonPropertyName("source")]
    public required string Source { get; init; }

    [JsonPropertyName("scanType")]
    public required string ScanType { get; init; }

    [JsonPropertyName("sourceId")]
    public required string SourceId { get; init; }

    [JsonPropertyName("description")]
    public required string Description { get; init; }

    [JsonPropertyName("caption")]
    public required string Caption { get; init; }

    [JsonPropertyName("severity")]
    public required string Severity { get; init; }

    [JsonPropertyName("status")]
    public required string Status { get; init; }

    [JsonPropertyName("suppressUntil")]
    public required bool? SuppressUntil { get; init; }

    [JsonPropertyName("isSystemSuppression")]
    public required bool IsSystemSuppression { get; init; }

    [JsonPropertyName("suppressMessage")]
    public required string? SuppressMessage { get; init; }

    [JsonPropertyName("suppressionJustification")]
    public required string SuppressionJustification { get; init; }

    [JsonPropertyName("suppressionAction")]
    public required string SuppressionAction { get; init; }

    [JsonPropertyName("isSuppressionFalsePositive")]
    public required bool IsSuppressionFalsePositive { get; init; }

    [JsonPropertyName("suppressionResearchedId")]
    public required string? SuppressionResearchedId { get; init; }

    [JsonPropertyName("suppressionResearchedUrl")]
    public required string? SuppressionResearchedUrl { get; init; }

    [JsonPropertyName("isStatusConfirmed")]
    public required bool IsStatusConfirmed { get; init; }

    [JsonPropertyName("foundOn")]
    public required string FoundOn { get; init; }

    [JsonPropertyName("lastDetected")]
    public required string LastDetected { get; init; }

    [JsonPropertyName("actionOn")]
    public required string? ActionOn { get; init; }

    [JsonPropertyName("operationType")]
    public required string OperationType { get; init; }

    [JsonPropertyName("ticket")]
    public required SoosVulnerabilityTicket? Ticket { get; init; }

    [JsonPropertyName("pullRequest")]
    public required bool? PullRequest { get; init; }

    [JsonPropertyName("project")]
    public required SoosVulnerabilityProject SoosVulnerabilityProject { get; init; }

    [JsonPropertyName("user")]
    public required SoosVulnerabilityUser? User { get; init; }

    [JsonPropertyName("packages")]
    public required string[] Packages { get; init; }

    [JsonPropertyName("hasFixes")]
    public required bool HasFixes { get; init; }

    [JsonPropertyName("vulnerabilityComplianceDaysRemaining")]
    public required int? VulnerabilityComplianceDaysRemaining { get; init; }

    [JsonPropertyName("SoosSourceDetail")]
    public required SoosVulnerabilitySourceDetail SoosVulnerabilitySourceDetail { get; init; }
}

[JsonSerializable(typeof(SoosVulnerabilityTicket))]
public sealed record SoosVulnerabilityTicket
{
    [JsonPropertyName("id")]
    public required string Id { get; init; }

    [JsonPropertyName("system")]
    public required string System { get; init; }

    [JsonPropertyName("url")]
    public required string Url { get; init; }

    [JsonPropertyName("status")]
    public required string Status { get; init; }
}

[JsonSerializable(typeof(SoosVulnerabilityProject))]
public sealed record SoosVulnerabilityProject
{
    [JsonPropertyName("id")]
    public required string Id { get; init; }

    [JsonPropertyName("name")]
    public required string Name { get; init; }
}

[JsonSerializable(typeof(SoosVulnerabilityUser))]
public sealed record SoosVulnerabilityUser
{
    [JsonPropertyName("firstName")]
    public required string FirstName { get; init; }

    [JsonPropertyName("lastName")]
    public required string LastName { get; init; }

    [JsonPropertyName("fullName")]
    public required string FullName { get; init; }
}

[JsonSerializable(typeof(SoosVulnerabilitySourceDetail))]
public sealed record SoosVulnerabilitySourceDetail
{
    [JsonPropertyName("vulnerability")]
    public required SoosVulnerabilitySourceDetailVulnerability Vulnerability { get; init; }
}

[JsonSerializable(typeof(SoosVulnerabilitySourceDetailVulnerability))]
public sealed record SoosVulnerabilitySourceDetailVulnerability
{
    [JsonPropertyName("cwes")]
    public required string[] Cwes { get; init; }

    [JsonPropertyName("exploitabilityScore")]
    public required double ExploitabilityScore { get; init; }

    [JsonPropertyName("isCisaExploitable")]
    public required bool IsCisaExploitable { get; init; }

    [JsonPropertyName("isExploitable")]
    public required bool IsExploitable { get; init; }

    [JsonPropertyName("description")]
    public required string Description { get; init; }

    [JsonPropertyName("originators")]
    public required string[] Originators { get; init; }
}